<div id="sectorMisVentas">
  <div class="top-space">
    <a class="left-arrow" routerLink="/home">
      <i class="fa-sharp fa-solid fa-arrow-left" style="color: #000000;"></i>
    </a>
    <h2 class="pageTitle">Ventas Realizadas</h2>
  </div>
  
  <table id="tablaVentas">
    <thead>
      <tr>
        <th class="columnaCentral">ID Venta</th>
        <th class="columnaImagen">Producto</th>
        <th class="columnaCentral">Cantidad</th>
        <th class="columnaCentral">Precio</th>
        <th class="columnaCentral">Total Venta</th>
        <th class="columnaCentral">Fecha</th>
        <th class="columnaCentral">Acciones</th>
      </tr>
    </thead>
    <tbody>
      @for (sale of sales; track sale.id) {
        <tr class="venta-row">
          <!-- ID de la venta -->
          <td>V-{{ sale.id }}</td>

          <!-- Celda fusionada: Producto + Cantidad + Precio -->
          <td [attr.colspan]="3">
            <div class="productosVenta">
              <div class="productosVenta__header">
                <span>Producto</span>
                <span>Cantidad</span>
                <span>Precio unitario</span>
              </div>

              @for (detail of sale.saleDetail; track detail.product.id) {
                <div class="productoDetalle">
                  <div class="productoDetalle__info">
                    <img
                      loading="lazy"
                      [src]="detail.product.images?.[0]?.url"
                      alt="{{ detail.product.name }}"
                      class="imgProducto"
                    />
                    <span>{{ detail.product.name }}</span>
                  </div>
                  <div class="productoDetalle__qty">
                    {{ detail.quantity }}
                  </div>
                  <div class="productoDetalle__price">
                    {{ '$' + detail.product.price }}
                  </div>
                </div>
              }
            </div>
          </td>

          <!-- Total de la venta -->
          <td>{{ '$' + sale.total }}</td>

          <!-- Fecha -->
          <td><p>{{ sale.saleDate | date: 'dd/MM/yyyy' }}</p></td>

          <!-- Acciones -->
          <td class="acciones">
            <a class="btnVerDetalle" (click)="abrirModal()" title="Ver detalle">
              <i class="fas fa-eye"></i>
            </a>
            <a class="btnEliminar" href="#" title="Eliminar">
              <i class="fas fa-trash"></i>
            </a>
          </td>
        </tr>
      }
    </tbody>
  </table>

  <!-- Modal emergente -->
  <div class="modalCliente" id="modalCliente">  
    <div class="modal-content">
        <h3>Información del Cliente</h3>
        <span class="close-btn" (click)="cerrarModal()">&times;</span>
      <div class="clienteInfo">
       <div class="clienteDato">
         <i class="fas fa-user"></i>
         <span>Juan Pérez</span>
       </div>
        <div class="clienteDato">
          <i class="fas fa-envelope"></i>
         <span>juanperez@email.com</span>
       </div>
        <div class="clienteDato">
          <i class="fas fa-map-marker-alt"></i>
          <span>Calle Falsa 123, Córdoba</span>
        </div>
        <div class="clienteDato">
          <i class="fas fa-phone"></i>
          <span>+54 9 351 555 5555</span>
        </div>
      </div>
    </div>
  </div>


  <div class="pagination">
    <button (click)="prevPage()" [disabled]="page === 1">
      ‹ Anterior
    </button>

    <div class="page-info">
      Página {{ page }} de {{ totalPages }}
    </div>

    <button (click)="nextPage()" [disabled]="page === totalPages">
      Siguiente ›
    </button>
  </div>
</div>
